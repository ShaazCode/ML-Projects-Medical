# -*- coding: utf-8 -*-
"""Patient Recovery Time Prediction Based on Drug Dosage.ipynb

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1VjgykJte9U4PoVn__09sQhOOPMV7tgjQ

# **Title: Patient Recovery Time Prediction Based on Drug Dosage (Simple Linear Regression)**
"""

import pandas as pd
import numpy as np
import matplotlib.pyplot as plt

"""What This Project Is
In clinical trials, researchers often study:
How drug dosage affects patient recovery time


Your project predicts recovery time (days)
using only ONE input:
Drug_Dosage (mg) ➜ Recovery_Days

Input & Output
Input (X): Drug Dosage (mg)

Output (Y): Patient Recovery Time (days)

This perfectly fits Simple Linear Regression
"""

df = pd.read_csv("clinical_recovery_linear_regression_dataset.csv")

df

df.info()

df.head()

print(df.to_string())

df.info()

df.isnull().sum()
# there no null data in this

"""**Step 03: Checking outlier**"""

# Points outside the box → outliers
# If very few → acceptable
# If many → need treatment

import matplotlib.pyplot as plt
import seaborn as sns

# Boxplot for Drug Dosage
plt.figure()
sns.boxplot(x=df['Drug_Dosage_mg'])
plt.title("Outliers in Drug Dosage")
plt.show()

# Boxplot for Recovery Days
plt.figure()
sns.boxplot(x=df['Recovery_Days'])
plt.title("Outliers in Recovery Days")
plt.show()

"""**Checking linear trends**"""

plt.figure()
plt.scatter(df['Drug_Dosage_mg'], df['Recovery_Days'])
plt.xlabel("Drug Dosage (mg)")
plt.ylabel("Recovery Days")
plt.title("Dosage vs Recovery Time")
plt.show()

import matplotlib.pyplot as plt

plt.figure()
plt.scatter(df['Drug_Dosage_mg'], df['Recovery_Days'])
plt.xlabel("Drug Dosage (mg)")
plt.ylabel("Recovery Days")
plt.title("Linear Trend Check: Dosage vs Recovery Time")
plt.show()

"""**Train–Test Split (Step-by-Step)**

"""

X = df[['Drug_Dosage_mg']]   # input feature (must be 2D)
y = df['Recovery_Days']     # target variable

# Why we split
# Training data → model learns the relationship
# Testing data → checks how well the model performs on unseen data
# Standard split: 80% train, 20% test

"""**Spliting the Data**"""

from sklearn.model_selection import train_test_split

X_train, X_test, y_train, y_test = train_test_split(
    X, y,
    test_size=0.2,
    random_state=42
)

"""**Verify the Split**"""

print("Training data size:", X_train.shape)
print("Testing data size:", X_test.shape)

"""**Model building**"""

# Import Linear Regression Model
from sklearn.linear_model import LinearRegression

# Create the Model Object
model = LinearRegression()

model.fit(X_train, y_train)

# Check Model Parameters
print("Slope (m):", model.coef_[0])
print("Intercept (c):", model.intercept_)

# Clinical Meaning
# Slope (m) → change in recovery days per 1 mg dosage
# Negative slope = higher dosage → faster recovery ✅

# Predict on Test Data
y_pred = model.predict(X_test)

import matplotlib.pyplot as plt

plt.figure()
plt.scatter(X_train, y_train)
plt.plot(X_train, model.predict(X_train))
plt.xlabel("Drug Dosage (mg)")
plt.ylabel("Recovery Days")
plt.title("Simple Linear Regression Model")
plt.show()

"""**Model Evaluation**"""

from sklearn.metrics import r2_score, mean_absolute_error, mean_squared_error
import numpy as np

r2 = r2_score(y_test, y_pred)
mae = mean_absolute_error(y_test, y_pred)
mse = mean_squared_error(y_test, y_pred)
rmse = np.sqrt(mse)

print("R² Score:", r2)
print("MAE:", mae)
print("MSE:", mse)
print("RMSE:", rmse)

# R² Score Tells how much variation in recovery time is explained by dosage
# Example: 0.75 → 75% of recovery time explained by dosage

# MAE (Mean Absolute Error) Average prediction error in days
# Example: MAE = 2.1 → model is off by ~2 days on average

# RMSE
# Penalizes large errors
# Important in clinical prediction

# New dosage value (must be 2D)
new_dosage = [[120]]   # 120 mg

predicted_days = model.predict(new_dosage)

print("Predicted Recovery Days:", predicted_days[0])

# Multiple dosage values
new_dosages = [[80], [100], [150], [180]]

predictions = model.predict(new_dosages)

for d, p in zip(new_dosages, predictions):
    print(f"Dosage: {d[0]} mg → Predicted Recovery Days: {p:.2f}")

