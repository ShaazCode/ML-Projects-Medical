# -*- coding: utf-8 -*-
"""Clinical_Trial_Duration_Prediction.ipynb

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1IdbkV7LxKLuPOW36fqdUebQWftV7h7xf

Title: Clinical Trial Duration Prediction
"""

import pandas as pd
import numpy as np
import matplotlib.pyplot as plt

df = pd.read_csv("clinical_trial_duration_2000_dirty_dataset.csv")

df

df.head()

df.shape

df.info()

df.describe()

df.isnull().sum()

df.hist(figsize=(12,8), bins=30)
plt.tight_layout()
plt.show()

# figsize=(12,8) → makes the overall chart bigger and clearer
# bins=30 → divides data into 30 bars (groups) for better visibility

# plt.tight_layout()
# Automatically adjusts spacing between plots.

# Skewness
# Spread of values
# Abnormal peaks

plt.figure(figsize=(12,4))

plt.subplot(1,4,1)
sns.boxplot(y=df['Num_Patients'])

plt.subplot(1,4,2)
sns.boxplot(y=df['Num_Sites'])

plt.subplot(1,4,3)
sns.boxplot(y=df['Num_Visits'])

plt.subplot(1,4,4)
sns.boxplot(y=df['Trial_Duration_Months'])

plt.tight_layout()
plt.show()

import seaborn as sns

df.isnull().sum()

df['Num_Patients'] = df['Num_Patients'].fillna(df['Num_Patients'].median())

df['Num_Patients'].isnull().sum()

df['Num_Sites'] = df['Num_Sites'].fillna(df['Num_Sites'].median())

df['Num_Visits'] = df['Num_Visits'].fillna(df['Num_Visits'].median())

df.isnull().sum()

df['Trial_Duration_Months'] = df['Trial_Duration_Months'].fillna(df['Trial_Duration_Months'].median())

df.info()

df.columns

# splitting input data and output data column

X = df[['Num_Patients', 'Num_Sites', 'Num_Visits']]

y = df['Trial_Duration_Months']

X

y

# verify the shape

print("X shape:", X.shape)
print("y shape:", y.shape)

# splitting dataset into training and testing dataset

from sklearn.model_selection import train_test_split

X_train, X_test, y_train, y_test = train_test_split(
    X, y,
    test_size=0.2,
    random_state=42
)

print("Training X shape:", X_train.shape)
print("Testing X shape:", X_test.shape)

print("Training y shape:", y_train.shape)
print("Testing y shape:", y_test.shape)

# Choosing model

from sklearn.linear_model import LinearRegression

# create object

model = LinearRegression()

# try to fit

model.fit(X_train, y_train)

# model prediction

y_pred = model.predict(X_test)

# Evaluation

from sklearn.metrics import r2_score, mean_absolute_error, mean_squared_error
import numpy as np

r2 = r2_score(y_test, y_pred)
mae = mean_absolute_error(y_test, y_pred)
rmse = np.sqrt(mean_squared_error(y_test, y_pred))

print("R² Score:", r2)
print("MAE:", mae)
print("RMSE:", rmse)

# output

num_patients = float(input("Enter number of patients: "))
num_sites = float(input("Enter number of sites: "))
num_visits = float(input("Enter number of visits: "))

# Create input DataFrame
user_input = pd.DataFrame({
    'Num_Patients': [num_patients],
    'Num_Sites': [num_sites],
    'Num_Visits': [num_visits]
})

# Predict
predicted_duration = model.predict(user_input)

print("Predicted Clinical Trial Duration (Months):", predicted_duration[0])

import seaborn as sns

import pandas as pd

data = {
    'Study_Hours': [2, 4, 6, 8, 10],
    'Score': [50, 60, 70, 85, 95]
}

df = pd.DataFrame(data)

import matplotlib.pyplot as plt
import seaborn as sns

sns.scatterplot(x='Study_Hours', y='Score', data=df)
plt.show()

