# -*- coding: utf-8 -*-
"""Regression-Evaluation.ipynb

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1-lw7kK7PqIddjYNPDe_VnUgXow36tbLA

**Title: Regression Evaluation**
"""

# Patient Recovery Time Prediction Based on Drug Dosage

import pandas as pd
import numpy as np
import matplotlib.pyplot as plt

df = pd.read_csv('clinical_recovery_linear_regression_dataset.csv')

df.info()

df.describe()

df.isnull().sum()

import matplotlib.pyplot as plt
import seaborn as sns

# Boxplot for Drug Dosage
plt.figure()
sns.boxplot(x=df['Drug_Dosage_mg'])
plt.title("Outliers in Drug Dosage")
plt.show()

# Boxplot for Recovery Days
plt.figure()
sns.boxplot(x=df['Recovery_Days'])
plt.title("Outliers in Recovery Days")
plt.show()

# Train test split

X = df[['Drug_Dosage_mg']]   # input feature (must be 2D)
y = df['Recovery_Days']

from sklearn.model_selection import train_test_split

X_train, X_test, y_train, y_test = train_test_split(
    X, y,
    test_size=0.2,
    random_state=42
)

from sklearn.linear_model import LinearRegression

model = LinearRegression()

model.fit(X_train, y_train)

# Check Model Parameters
print("Slope (m):", model.coef_[0])
print("Intercept (c):", model.intercept_)

y_pred = model.predict(X_test)

# Evaluation

from sklearn.metrics import r2_score, mean_absolute_error, mean_squared_error

# mae

mae = mean_absolute_error(y_test, y_pred)
mae

mse = mean_squared_error(y_test, y_pred)

rmse = np.sqrt(mse)

mae

mse

rmse

r2 = r2_score(y_test, y_pred)

r2

# so this is evalaution technique thats comes under regression